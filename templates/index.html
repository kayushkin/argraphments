<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>argraphments</title>
    <link rel="stylesheet" href="{{.BasePath}}/static/style.css">
</head>
<body>
    <div class="container">
        <header id="header">
            <a href="{{.BasePath}}/" onclick="event.preventDefault(); showInputs()" class="header-brand">argraphments</a>
            <nav class="header-nav">
                <a href="{{.BasePath}}/speakers" onclick="event.preventDefault(); loadSpeakersPage()">speakers</a>
                <a href="{{.BasePath}}/conversations" onclick="event.preventDefault(); loadConversationsPage()">conversations</a>
            </nav>
            <a href="https://kayushkin.com" class="attribution">kayushkin.com</a>
        </header>

        <div class="input-section" id="input-section">
            <div class="input-row">
                <button id="record-btn" class="btn btn-record" onclick="toggleRecording('mic')">
                    <span class="record-dot"></span> Mic
                </button>
                <button id="tab-record-btn" class="btn btn-record" onclick="toggleRecording('tab')">
                    <span class="record-dot"></span> Tab Audio
                </button>
                <span id="record-time" class="record-time">00:00</span>

                <label class="btn btn-upload">
                    <input type="file" name="audio" accept="audio/*,video/*" onchange="uploadFile(this)" hidden>
                    Upload Audio
                </label>
            </div>

            <div id="record-status"></div>

            <div class="youtube-import">
                <form onsubmit="event.preventDefault(); importYouTube(this.url.value)">
                    <div class="input-row">
                        <input type="text" name="url" placeholder="YouTube URL" class="yt-url-input">
                        <button type="submit" class="btn">Import</button>
                    </div>
                </form>
                <div id="yt-status"></div>
            </div>

            <form onsubmit="event.preventDefault(); submitPasteForDiarize(this);">
                <textarea name="transcript" rows="8" placeholder="Or paste a conversation transcript here..."></textarea>
                <div class="input-row" style="margin-top:0.5rem">
                    <button type="submit" class="btn">Analyze</button>
                    <button type="button" class="btn btn-secondary" onclick="submitTestConvo()">Try a sample</button>
                </div>
            </form>

            <div class="discovery" id="discovery" style="display:none">
                <div class="discovery-col" id="discovery-speakers">
                    <h3>Speakers</h3>
                    <div class="speakers-list" id="speakers-list"></div>
                </div>
                <div class="discovery-col" id="discovery-conversations">
                    <h3>Conversations</h3>
                    <div class="conversations-list" id="conversations-list"></div>
                </div>
            </div>
        </div>

        {{template "header.html"}}

        <div id="spinner" class="htmx-indicator">
            <div class="spinner"></div>
            <span>Processing...</span>
        </div>

        <div id="result"></div>

        <template id="tmpl-live-session">
            <div class="live-session">
                <div class="diarized-view" id="diarized-view">
                    <div class="section-header">
                        <span class="section-label">Transcript</span>
                        <button class="btn-minimize" onclick="toggleSection('diarized-view')" title="Minimize">−</button>
                    </div>
                    <div class="section-body" id="diarized-view-body">
                        <div class="chat-messages" id="chat-messages">
                            <div class="chat-msg"><span class="chat-text interim" id="session-status">Listening...</span></div>
                        </div>
                    </div>
                </div>
                <div class="argument-section" id="argument-section" style="display:none">
                    <div class="section-header">
                        <span class="section-label">Argument Tree</span>
                        <button class="btn-minimize" onclick="toggleSection('argument-section')" title="Minimize">−</button>
                    </div>
                    <div class="section-body" id="argument-section-body">
                        <div id="argument-tree"></div>
                    </div>
                </div>
            </div>
        </template>
    </div>

    <script src="{{.BasePath}}/static/app.js"></script>
</body>
</html>
